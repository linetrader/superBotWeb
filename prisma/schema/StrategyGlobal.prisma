// prisma/schema/StrategyGlobal.prisma
model StrategyGlobalSettings {
  id         String   @id @default(cuid())
  bbw_thresh Decimal  @db.Decimal(12, 6)
  bb_period  Int
  bb_k       Decimal  @db.Decimal(5, 2)
  trend_fast Int
  trend_slow Int
  is_active  Boolean  @default(true)
  version    Int      @default(1)
  updated_at DateTime @default(now()) @db.Timestamptz(6)
  created_at DateTime @default(now()) @db.Timestamptz(6)

  // ğŸ”§ ì—­ì°¸ì¡° í•„ë“œ ì¶”ê°€(ê´€ê³„ ì´ë¦„ ëª…ì‹œ)
  histories StrategyGlobalSettingsHistory[] @relation("GlobalSettingsHistory")

  @@index([is_active], map: "ix_strategy_global_is_active")
}

model StrategyGlobalSettingsHistory {
  // íŠ¸ë¦¬ê±°ë¡œ DBê°€ ì§ì ‘ INSERT í•  ì˜ˆì •ì´ë©´ DB ê¸°ë³¸ê°’ ì‚¬ìš© ê¶Œì¥
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  settings_id String

  bbw_thresh  Decimal  @db.Decimal(12, 6)
  bb_period   Int
  bb_k        Decimal  @db.Decimal(5, 2)
  trend_fast  Int
  trend_slow  Int
  version     Int
  changed_at  DateTime @default(now()) @db.Timestamptz(6)

  // ğŸ”§ ëª…ì‹œì  relation ì´ë¦„ì„ ë¶€ëª¨ì™€ ë™ì¼í•˜ê²Œ ì§€ì •
  settings StrategyGlobalSettings @relation("GlobalSettingsHistory", fields: [settings_id], references: [id], onDelete: Cascade)
}
